{% comment %}
  Template para Predictive Search (Busca Preditiva)
  Renderiza resultados r√°pidos (Produtos, Cole√ß√µes, P√°ginas) para o dropdown de busca.
{% endcomment %}

{%- if predictive_search.performed -%}
  <div id="predictive-search-results">
    {%- if predictive_search.resources.products.size > 0 -%}
      <h3 id="predictive-search-products" class="predictive-search__heading font-heading">
        Produtos
      </h3>
      <ul role="listbox" aria-labelledby="predictive-search-products" class="predictive-search__results-list">
        {%- for product in predictive_search.resources.products -%}
          <li role="option" class="predictive-search__list-item">
            <a href="{{ product.url }}" class="predictive-search__item" tabindex="-1">
              {%- if product.featured_media != blank -%}
                <img class="predictive-search__item-image"
                  src="{{ product.featured_media | image_url: width: 150 }}"
                  alt="{{ product.featured_media.alt }}"
                  width="50"
                  height="{{ 50 | divided_by: product.featured_media.aspect_ratio | ceil }}"
                >
              {%- endif -%}
              <div class="predictive-search__item-content text-left">
                <span class="predictive-search__item-heading">{{ product.title }}</span>
                <span class="predictive-search__item-price">{{ product.price | money }}</span>
              </div>
            </a>
          </li>
        {%- endfor -%}
      </ul>
    {%- endif -%}

    {%- if predictive_search.resources.collections.size > 0 -%}
       <h3 id="predictive-search-collections" class="predictive-search__heading font-heading">
        Cole√ß√µes
      </h3>
      <ul role="listbox" aria-labelledby="predictive-search-collections" class="predictive-search__results-list">
        {%- for collection in predictive_search.resources.collections -%}
          <li role="option" class="predictive-search__list-item">
            <a href="{{ collection.url }}" class="predictive-search__item" tabindex="-1">
              <span class="predictive-search__item-heading">{{ collection.title }}</span>
            </a>
          </li>
        {%- endfor -%}
      </ul>
    {%- endif -%}

    {%- if predictive_search.resources.products.size == 0 and predictive_search.resources.collections.size == 0 -%}
      <div class="predictive-search__demo-mode" style="padding: 1rem;">
        <h3 class="predictive-search__heading font-heading" style="background: none; border: none; padding-left: 0;">Sugest√µes Premium (Demo)</h3>
        <p class="text-secondary" style="font-size: 0.85rem; margin-bottom: 1rem;">Como voc√™ ainda n√£o cadastrou produtos, aqui est√° uma pr√©via da experi√™ncia Apple que seus clientes ter√£o:</p>
        
        <ul role="listbox" class="predictive-search__results-list">
          <li class="predictive-search__list-item">
            <div class="predictive-search__item">
              <div style="width: 50px; height: 50px; background: #eee; border-radius: 4px; display: flex; align-items: center; justify-content: center;">üçì</div>
              <div class="predictive-search__item-content text-left">
                <span class="predictive-search__item-heading">Morango Hidrop√¥nico Selecionado</span>
                <span class="predictive-search__item-price">R$ 24,90</span>
              </div>
            </div>
          </li>
          <li class="predictive-search__list-item">
            <div class="predictive-search__item">
              <div style="width: 50px; height: 50px; background: #eee; border-radius: 4px; display: flex; align-items: center; justify-content: center;">ü´ê</div>
              <div class="predictive-search__item-content text-left">
                <span class="predictive-search__item-heading">Mirtilo (Blueberry) Safra Especial</span>
                <span class="predictive-search__item-price">R$ 32,00</span>
              </div>
            </div>
          </li>
          <li class="predictive-search__list-item">
            <div class="predictive-search__item">
              <div style="width: 50px; height: 50px; background: #eee; border-radius: 4px; display: flex; align-items: center; justify-content: center;">üß∫</div>
              <div class="predictive-search__item-content text-left">
                <span class="predictive-search__item-heading">Cesta de Caf√© da Manh√£ "Raminho Heritage"</span>
                <span class="predictive-search__item-price">R$ 289,00</span>
              </div>
            </div>
          </li>
        </ul>
      </div>
    {%- endif -%}

    <div class="predictive-search__view-all text-center" style="margin-top: 1rem; border-top: 1px solid rgba(0,0,0,0.1); padding-top: 1rem;">
      <button class="btn-text" onclick="this.closest('form').submit();">
        Ver todos os resultados para "{{ predictive_search.terms }}"
      </button>
    </div>
  </div>
{%- endif -%}

<style>
  .predictive-search__heading {
    font-size: 1.2rem;
    padding: 1rem;
    margin: 0;
    color: var(--color-primary-dark);
    background: var(--color-background-alt);
    border-bottom: 1px solid rgba(0,0,0,0.05);
  }
  .predictive-search__results-list {
    list-style: none;
    padding: 0;
    margin: 0;
  }
  .predictive-search__item {
    display: flex;
    align-items: center;
    gap: 1.5rem;
    padding: 1rem;
    text-decoration: none;
    color: var(--color-text);
    transition: background 0.2s;
  }
  .predictive-search__item:hover {
    background: var(--color-background-alt);
  }
  .predictive-search__item-image {
    object-fit: cover;
    border-radius: 4px;
    background: #f9f9f9;
  }
  .predictive-search__item-heading {
    display: block;
    font-weight: 500;
  }
  .predictive-search__item-price {
    font-size: 0.9rem;
    opacity: 0.7;
  }
</style>

{% schema %}
{
  "name": "Predictive Search",
  "settings": []
}
{% endschema %}
